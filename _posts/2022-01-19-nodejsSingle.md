---
layout: single
title: "Node.js의 작동 방식"
---

JavaScript는 싱글스레드이다.

Node.js는 JavaScript를 기반으로 한 V8 엔진으로 빌드된 런타임 환경이다.

그렇다면 Node.js는 싱글스레드일까? 에 대한 궁금증에 대한 정리를 해보자.

## 스레드란?

우선 싱글 스레드에서 “스레드”란 무엇인지 알고가자.

실행 준비가 완료된 코드들의 묶음이 프로그램이고,

이 프로그램들이 실행되고 있어서 CPU의 처리 과정에 속하게 되면 Process, 프로세스라고 한다.

CPU가 처리해야 할 프로세스들이 쌓이면,

즉 CPU가 처리할 작업들이 쌓여있는 리스트를 스레드라고 할 수 있다.

또는, CPU의 “코어”라는 노동자의 팔 개수라고 비유하기도 한다.

## 싱글스레드와 멀티스레드란?

싱글스레드는 하나의 스레드만 가지고, 멀티스레드는 2개 이상의 스레드를 가지는 방식이다.

알아두고 가야 할 것은, 멀티스레드라고 싱글스레드보다 무조건 좋은 방식인 것은 아니다.

## Node.js는 싱글스레드인가 멀티스레드인가?

결론적으로 이야기 하자면, Node.js는 V8 엔진에 비동기 이벤트 처리 라이브러리(libuv)를 결합했는데,

비동기 이벤트 처리에 가장 적합한 방식은 싱글스레드 방식이기 때문에 Node.js는 싱글스레드이다.

## 이벤트 루프

그렇다면 이벤트 처리, 즉 이벤트 루프란 무엇일까?

```jsx
const eventLoop = () => {
  console.log(1);
  setTimeout(() => {
    console.log(2);
  }, 5000);
  setTimeout(() => {
    console.log(3);
  }, 0);
  console.log(4);
};
```

위의 코드대로 입력했을 때, 콘솔에는 어느 순서로 출력이 될까?

얼마 전에 알아봤던 Hoisting 포스팅에서 봤듯이, JavaScript는 인터프리터에 의해서

위에서부터 순차적으로 코드가 실행, 즉 동기적으로 실행되기 때문에

1이 찍히고, 5초뒤에 2, 곧이어 3과 4가 순서대로 출력될 것이라고 생각할 수 있지만,

setTimeout 함수는 비동기로 동작하는 Web API이기 때문에

1 → 4 → 3 → 2 의 순서대로 출력된다.

![스크린샷 2022-01-19 23.49.38.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5db5f6e3-7da0-4aec-a049-e54ad8b72680/스크린샷_2022-01-19_23.49.38.png)

가장 먼저 코드가 실행(main)되면서 Stack에 쌓이고,
